---
title: "Genome Features"
description: "Beds and such"
format:
  html:
    code-copy: true
    toc: true
    toc-location: right
    toc-expand: true
editor: visual
execute:
  echo: false
  warning: false
  message: false
---

```{r setup, include=FALSE}
library(tidyverse)
library(DT)
library(readxl)
library(plotly)
library(readr)
library(dplyr)
library(tibble)
library(knitr)
library(gt)
library(htmltools)
```

```{r read_in}

# Define key paths and tool directories


Apul_gff_url <- "https://raw.githubusercontent.com/urol-e5/MOSAiC/refs/heads/main/data/Apul/Apul_gene_only.gff"



Apul_lncRNAloc_url <- "https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/D-Apul/output/31-Apul-lncRNA-discovery/lncRNA.gtf"


Peve_gff_url <- "https://raw.githubusercontent.com/urol-e5/timeseries_molecular/refs/heads/main/E-Peve/output/00.01-Peve-gene-gff/Peve_gene_only.gff3"



Peve_lncRNAloc_url <- "https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/E-Peve/output/12-Peve-lncRNA-discovery/lncRNA.gtf"



## Ptuh gene URL temporarily disabled (invalid/mismatched)
# Ptuh_gff_url <- "https://raw.githubusercontent.com/urol-e5/timeseries_molecular/refs/heads/main/F-Ptua/output/00.01-Ptua-gene-gff/Pmea_gene_only.gff3"



## Ptuh lncRNA URL temporarily disabled (invalid/mismatched)
# Ptuh_lncRNAloc_url <- "https://raw.githubusercontent.com/urol-e5/timeseries_molecular/refs/heads/main/E-Peve/output/12-Peve-lncRNA-discovery/lncRNA.filtered.gtf"




# read in 
Apul_gff <- read_delim(
  Apul_gff_url,
  delim = "\t"
)

Apul_lncRNAloc <- read_delim(
  Apul_lncRNAloc_url,
  delim = "\t",
  col_names = c(
    "seqid", "source", "type", "start", "end",
    "score", "strand", "phase", "attributes"
  ))

Peve_gff <- read_delim(
  Peve_gff_url,
  delim = "\t",
  col_names = c(
    "seqid", "source", "type", "start", "end",
    "score", "strand", "phase", "attributes"
  ))

Peve_lncRNAloc <- read_delim(
  Peve_lncRNAloc_url,
  delim = "\t",
  col_names = c(
    "seqid", "source", "type", "start", "end",
    "score", "strand", "phase", "attributes"
  ))

Ptuh_gff <- read_delim(
  Ptuh_gff_url,
  delim = "\t",
  col_names = c(
    "seqid", "source", "type", "start", "end",
    "score", "strand", "phase", "attributes"
  ))

Ptuh_lncRNAloc <- read_delim(
  Ptuh_lncRNAloc_url,
  delim = "\t",
  col_names = c(
    "seqid", "source", "type", "start", "end",
    "score", "strand", "phase", "attributes"
  ))


```

| Species | Gene | miRNA | lncRNA | mCpG |
|---------------|---------------|---------------|---------------|---------------|
| *Acropora pulchra* | **`r nrow(Apul_gff)`** |  | **`r nrow(Apul_lncRNAloc)`** |  |
| *Porites evermanni* | **`r nrow(Peve_gff)`** |  | **`r nrow(Peve_lncRNAloc)`** |  |
| *Pocillopora tuahiniensis* | **`r nrow(Ptuh_gff)`** |  | **`r nrow(Ptuh_lncRNAloc)`** |  |

# *Acropora pulchra*

Genes

```{r}
#| echo: false
#| results: asis

cat(as.character(
  tags$a(
    href = Apul_gff_url,
    class = "btn btn-primary",
    target = "_blank",
    download = "Apul_gene_only.gff",
    "Download Gene GFF"
  )
))
```

```{r}
#| results: asis
urls <- c(Apul_gff_url)

for (i in seq_along(urls)) {
  cat("``` bash\n", urls[i], "\n```\n\n", sep = "")
}
```

```{r}
Apul_gff |>
  slice_head(n = 4) |>
  gt()
```

lncRNAs

```{r}
#| echo: false
#| results: asis

cat(as.character(
  tags$a(
    href = Apul_lncRNAloc_url,
    class = "btn btn-primary",
    target = "_blank",
    download = "Apul_lncRNA.gtf",
    "Download lncRNA GTF"
  )
))
```

```{r}
#| results: asis
urls <- c(Apul_lncRNAloc_url)

for (i in seq_along(urls)) {
  cat("``` bash\n", urls[i], "\n```\n\n", sep = "")
}
```

```{r}
Apul_lncRNAloc |>
  slice_head(n = 4) |>
  gt()
```

# Porites evermanni

Genes

```{r}
#| echo: false
#| results: asis

cat(as.character(
  tags$a(
    href = Peve_gff_url,
    class = "btn btn-primary",
    target = "_blank",
    download = "Peve_gene_only.gff",
    "Download Gene GFF"
  )
))
```

```{r}
#| results: asis
urls <- c(Peve_gff_url)

for (i in seq_along(urls)) {
  cat("``` bash\n", urls[i], "\n```\n\n", sep = "")
}
```

```{r}
Peve_gff |>
  slice_head(n = 4) |>
  gt()
```

lncRNAs

```{r}
#| echo: false
#| results: asis

cat(as.character(
  tags$a(
    href = Peve_lncRNAloc_url,
    class = "btn btn-primary",
    target = "_blank",
    download = "Peve_lncRNA.gtf",
    "Download lncRNA GTF"
  )
))
```

```{r}
#| results: asis
urls <- c(Peve_lncRNAloc_url)

for (i in seq_along(urls)) {
  cat("``` bash\n", urls[i], "\n```\n\n", sep = "")
}
```

```{r}
Peve_lncRNAloc |>
  slice_head(n = 4) |>
  gt()
```

# Pocillopora tuahiniensis (DISCLAIMER)

Genes

```{r}
#| echo: false
#| results: asis

cat(as.character(
  tags$a(
    href = Ptuh_gff_url,
    class = "btn btn-primary",
    target = "_blank",
    download = "Ptuh_gene_only.gff",
    "Download Gene GFF"
  )
))
```

```{r}
#| results: asis
urls <- c(Ptuh_gff_url)

for (i in seq_along(urls)) {
  cat("``` bash\n", urls[i], "\n```\n\n", sep = "")
}
```

```{r}
Ptuh_gff |>
  slice_head(n = 4) |>
  gt()
```

lncRNAs

```{r}
#| echo: false
#| results: asis

cat(as.character(
  tags$a(
    href = Ptuh_lncRNAloc_url,
    class = "btn btn-primary",
    target = "_blank",
    download = "Ptuh_lncRNA.gtf",
    "Download lncRNA GTF"
  )
))
```

```{r}
#| results: asis
urls <- c(Ptuh_lncRNAloc_url)

for (i in seq_along(urls)) {
  cat("``` bash\n", urls[i], "\n```\n\n", sep = "")
}
```

```{r}
Ptuh_lncRNAloc |>
  slice_head(n = 4) |>
  gt()
```
